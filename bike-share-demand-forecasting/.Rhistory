# =============================================================================
# PROJECT: BIKE SHARE DEMAND FORECASTING
# Using Linear Regression to predict bike rental counts
# Data: bikeshare.csv
# =============================================================================
# Load libraries
library(tidyverse)
library(caret)
library(corrplot)
library(caTools)
# Set seed
set.seed(101)
# Load data
bikeshare <- read.csv("data/bikeshare.csv")
# Remove NA values
bikeshare <- na.omit(bikeshare)
any(is.na(bikeshare))
# Exploratory Data Analysis
head(bikeshare)
str(bikeshare)
# Visualizations
# Scatter plot of count vs temp
ggplot(data = bikeshare, aes(x = temp, y = count)) +
geom_point(aes(colour = temp), alpha = 0.1, size = 2) +
theme_minimal()
# Convert datetime
bikeshare$datetime <- as.POSIXct(bikeshare$datetime, format = "%Y-%m-%d %H:%M:%S")
# Scatter plot of count vs datetime
ggplot(data = bikeshare, aes(x = datetime, y = count)) +
geom_point(aes(colour = temp), size = 2, alpha = 0.5) +
scale_color_continuous(low = "#55D8CE", high = "#FF6E2E") +
theme_minimal()
# Correlation
cor(bikeshare[, c("temp", "count")], use = "complete.obs")
# Boxplot by season
ggplot(data = bikeshare, aes(x = factor(season), y = count)) +
geom_boxplot(aes(color = factor(season))) +
theme_minimal()
# Feature engineering
bikeshare$hour <- format(bikeshare$datetime, "%H")
# Working day plots
bikeshare_wd1 <- bikeshare %>% filter(bikeshare$workingday == 1)
ggplot(data = bikeshare_wd1, aes(x = hour, y = count)) +
geom_point(aes(colour = temp), position = position_jitter(w = 1, h = 0),
size = 2, alpha = 0.5) +
scale_color_gradientn(colors = c('darkblue', 'blue', 'lightblue', 'lightgreen',
'yellow', 'orange', 'red')) +
theme_minimal()
# Non-working day plots
bikeshare_wd0 <- bikeshare %>% filter(bikeshare$workingday == 0)
ggplot(data = bikeshare_wd0, aes(x = hour, y = count)) +
geom_point(aes(colour = temp), position = position_jitter(w = 1, h = 0),
size = 2, alpha = 0.5) +
scale_color_gradientn(colors = c('darkblue', 'blue', 'lightblue', 'lightgreen',
'yellow', 'orange', 'red')) +
theme_minimal()
# Correlation analysis
bnum.col <- sapply(bikeshare, is.numeric)
bcor.data <- cor(bikeshare[, bnum.col])
corrplot(corr = bcor.data, method = "color")
# Distribution of count
ggplot(data = bikeshare, aes(x = count)) +
geom_histogram(bins = 20, fill = "blue", color = "red") +
theme_minimal()
# Simple linear regression with temperature
bikeshare_model <- lm(count ~ temp, data = bikeshare)
summary(bikeshare_model)
# Predict for 25 degrees
pred_rental <- predict(bikeshare_model, newdata = data.frame(temp = 25))
cat("Predicted rentals at 25°C:", pred_rental, "\n")
# Multiple regression model
bikeshare$hour <- sapply(bikeshare$hour, as.numeric)
bikeshare$hour <- factor(bikeshare$hour)
bikeshare_m_model <- lm(count ~ . - datetime - casual - registered - atemp,
data = bikeshare)
summary(bikeshare_m_model)
# =============================================================================
# PROJECT: BIKE SHARE DEMAND FORECASTING USING LINEAR REGRESSION
# =============================================================================
# Load required libraries
library(tidyverse)
library(caret)
library(corrplot)
library(caTools)
# Set seed for reproducibility
set.seed(101)
# Load data
bikeshare <- read.csv("data/bikeshare.csv")
# Remove NA values
bikeshare <- na.omit(bikeshare)
any(is.na(bikeshare))
# Exploratory Data Analysis
head(bikeshare)
str(bikeshare)
# Visualizations
ggplot(data = bikeshare, aes(x = temp, y = count)) +
geom_point(aes(colour = temp), alpha = 0.1, size = 2) +
theme_minimal()
# Convert datetime
bikeshare$datetime <- as.POSIXct(bikeshare$datetime, format = "%Y-%m-%d %H:%M:%S")
# Scatter plot of count vs datetime
ggplot(data = bikeshare, aes(x = datetime, y = count)) +
geom_point(aes(colour = temp), size = 2, alpha = 0.5) +
scale_color_continuous(low = "#55D8CE", high = "#FF6E2E") +
theme_minimal()
# Correlation between temp and count
cor(bikeshare[, c("temp", "count")], use = "complete.obs")
# Boxplot by season
ggplot(data = bikeshare, aes(x = factor(season), y = count)) +
geom_boxplot(aes(color = factor(season))) +
theme_minimal()
# Feature engineering - extract hour from datetime
bikeshare$hour <- format(bikeshare$datetime, "%H")
# Plot for working days
bikeshare_wd1 <- bikeshare %>% filter(bikeshare$workingday == 1)
ggplot(data = bikeshare_wd1, aes(x = hour, y = count)) +
geom_point(aes(colour = temp), position = position_jitter(w = 1, h = 0),
size = 2, alpha = 0.5) +
scale_color_gradientn(colors = c('darkblue', 'blue', 'lightblue', 'lightgreen',
'yellow', 'orange', 'red')) +
theme_minimal()
# Plot for non-working days
bikeshare_wd0 <- bikeshare %>% filter(bikeshare$workingday == 0)
ggplot(data = bikeshare_wd0, aes(x = hour, y = count)) +
geom_point(aes(colour = temp), position = position_jitter(w = 1, h = 0),
size = 2, alpha = 0.5) +
scale_color_gradientn(colors = c('darkblue', 'blue', 'lightblue', 'lightgreen',
'yellow', 'orange', 'red')) +
theme_minimal()
# Correlation analysis
bnum.col <- sapply(bikeshare, is.numeric)
bcor.data <- cor(bikeshare[, bnum.col])
corrplot(corr = bcor.data, method = "color")
# Distribution of count
ggplot(data = bikeshare, aes(x = count)) +
geom_histogram(bins = 20, fill = "blue", color = "red") +
theme_minimal()
# Simple linear regression with temperature
bikeshare_model <- lm(count ~ temp, data = bikeshare)
summary(bikeshare_model)
# Predict for 25 degrees Celsius
pred_rental <- predict(bikeshare_model, newdata = data.frame(temp = 25))
cat("Predicted bike rentals at 25°C:", round(pred_rental, 0), "\n")
# Multiple regression model
bikeshare$hour <- sapply(bikeshare$hour, as.numeric)
bikeshare$hour <- factor(bikeshare$hour)
bikeshare_m_model <- lm(count ~ . - datetime - casual - registered - atemp,
data = bikeshare)
summary(bikeshare_m_model)
