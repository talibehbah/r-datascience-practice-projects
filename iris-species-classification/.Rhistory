# =============================================================================
# PROJECT 7: IRIS SPECIES CLASSIFICATION USING KNN
# =============================================================================
# Load required libraries
library(class)
library(caTools)
library(ggplot2)
# Load Iris dataset
data(iris)
# Exploratory Data Analysis
cat("=== IRIS DATASET OVERVIEW ===\n")
head(iris)
str(iris)
# Check variance of first two columns
cat("\n=== VARIANCE CHECK ===\n")
cat("Variance of Sepal.Length:", var(iris[,1]), "\n")
cat("Variance of Sepal.Width:", var(iris[,2]), "\n")
# Extract species and standardize data
species <- iris[,5]
standardised.iris <- scale(iris[,-5])
cat("\n=== VARIANCE AFTER STANDARDIZATION ===\n")
cat("Variance of standardized Sepal.Length:", var(standardised.iris[,1]), "\n")
cat("Variance of standardized Sepal.Width:", var(standardised.iris[,2]), "\n")
# Split data
set.seed(101)
split.idata <- sample.split(iris$Species, SplitRatio = 0.7)
# Training set
train.idata <- subset(standardised.iris, split.idata == TRUE)
train.species <- subset(species, split.idata == TRUE)
# Testing set
test.idata <- subset(standardised.iris, split.idata == FALSE)
test.species <- subset(species, split.idata == FALSE)
cat("\n=== DATA SPLIT ===\n")
cat("Training set size:", nrow(train.idata), "\n")
cat("Testing set size:", nrow(test.idata), "\n")
# KNN Model with k=3
set.seed(101)
predicted.species <- knn(train.idata, test.idata, train.species, k = 3)
cat("\n=== KNN PREDICTIONS (FIRST 10) ===\n")
print(head(predicted.species, 10))
# Calculate error rate
error.rate <- mean(test.species != predicted.species)
cat("\n=== MODEL PERFORMANCE ===\n")
cat("Error Rate (k=3):", error.rate, "\n")
cat("Accuracy (k=3):", 1 - error.rate, "\n")
# Find optimal k value
predicted.species <- NULL
error.rate <- NULL
for (i in 1:20) {
set.seed(101)
predicted.species <- knn(train.idata, test.idata, train.species, k = i)
error.rate[i] <- mean(test.species != predicted.species)
}
# Create error rate dataframe
k.values <- 1:20
error.df <- data.frame(k.values, error.rate)
cat("\n=== ERROR RATES FOR DIFFERENT K VALUES ===\n")
print(error.df)
# Visualize error rates vs k values
ggplot(data = error.df, aes(x = k.values, y = error.rate)) +
geom_point() +
geom_line(linetype = "dotted", color = "red") +
labs(title = "KNN Error Rate vs K Value for Iris Classification",
x = "K Value", y = "Error Rate") +
theme_minimal()
# Find optimal k (minimum error rate)
optimal.k <- which.min(error.rate)
cat("\n=== OPTIMAL K VALUE ===\n")
cat("Optimal k:", optimal.k, "with error rate:", error.rate[optimal.k], "\n")
cat("Accuracy with optimal k:", 1 - error.rate[optimal.k], "\n")
# Visualize the data
ggplot(data = iris, aes(x = Petal.Width, y = Petal.Length)) +
geom_point(aes(color = Species, size = Sepal.Width)) +
labs(title = "Iris Species: Petal Width vs Petal Length",
x = "Petal Width", y = "Petal Length") +
theme_minimal()
